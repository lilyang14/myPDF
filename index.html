<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>个人作品集</title>
    <link rel="apple-touch-icon" sizes="180x180" href="favicon_io/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="favicon_io/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="favicon_io/favicon-16x16.png">
    <link rel="manifest" href="favicon_io/site.webmanifest">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            background: #1C1C1C;
            color: #fff;
            font-family: -apple-system, BlinkMacSystemFont, sans-serif;
            padding-top: 60px;
            min-height: 100vh;
        }
        
        .loading {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100vh;
            background: #1C1C1C;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            transition: opacity 0.5s;
        }
        
        .loading.hidden { opacity: 0; pointer-events: none; }
        
        .progress {
            width: 48px; height: 48px;
            margin-bottom: 20px;
        }
        
        .progress-ring {
            width: 100%; height: 100%;
            transform: rotate(-90deg);
        }
        
        .progress-ring circle {
            cx: 24; cy: 24; r: 20;
            fill: none;
            stroke: #fff;
            stroke-width: 4;
            stroke-linecap: round;
            stroke-dasharray: 126;
            stroke-dashoffset: 126;
            transition: stroke-dashoffset 0.5s, stroke 0.5s;
        }
        
        .loading-text {
            font-size: 14px;
            color: #fff;
            text-align: center;
            line-height: 1.4;
        }
        
        .loading-percent {
            font-size: 16px;
            font-weight: 500;
            margin-top: 4px;
            transition: color 0.5s;
        }
        
        .portfolio {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 100%;
        }
        
        .image-item {
            width: 100%;
            display: flex;
            justify-content: center;
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.6s, transform 0.6s;
        }
        
        .image-item.show { opacity: 1; transform: translateY(0); }
        
        .image-item img {
            width: 100%;
            height: auto;
            display: block;
            pointer-events: none;
            user-select: none;
        }
        
        .error {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100vh;
            background: #1C1C1C;
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 1001;
        }
        
        .error.show { display: flex; }
        
        .error-text {
            font-size: 20px;
            margin-bottom: 20px;
        }
        
        .reload-btn {
            width: 96px; height: 36px;
            background: rgba(255, 255, 255, 0.2);
            border: none; border-radius: 4px;
            color: #fff; font-size: 14px;
            cursor: pointer;
        }
        
        .protect-overlay {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            z-index: 9999;
        }
        
        @media (min-width: 769px) {
            .image-item img {
                width: 65%;
                max-width: 1200px;
            }
        }
    </style>
</head>
<body>
    <div class="protect-overlay" oncontextmenu="return false" onselectstart="return false" ondragstart="return false"></div>
    
    <div class="loading" id="loading">
        <div class="progress">
            <svg class="progress-ring" viewBox="0 0 48 48">
                <circle id="progressCircle" cx="24" cy="24" r="20"></circle>
            </svg>
        </div>
        <div class="loading-text">
            作品集加载中...<br>
            <span class="loading-percent" id="percent">0%</span>
        </div>
    </div>
    
    <div class="error" id="error">
        <div class="error-text">网络异常，请重新加载</div>
        <button class="reload-btn" id="reloadBtn">重新加载</button>
    </div>
    
    <div class="portfolio" id="portfolio"></div>

    <script>
        // 基础功能
        window.onload = () => window.scrollTo(0, 0);
        document.addEventListener('contextmenu', e => e.preventDefault());
        document.addEventListener('dragstart', e => e.target.tagName === 'IMG' && e.preventDefault());
        document.addEventListener('selectstart', e => e.preventDefault());
        
        // 进度条控制
        const circle = document.getElementById('progressCircle');
        const circumference = 2 * Math.PI * 20;
        circle.style.strokeDasharray = circumference;
        circle.style.strokeDashoffset = circumference;
        
        const updateProgress = (loaded, total) => {
            const percent = Math.round((loaded / total) * 100) || 0;
            document.getElementById('percent').textContent = percent + '%';
            circle.style.strokeDashoffset = circumference - (percent / 100) * circumference;
            
            if (loaded === total && total > 0) {
                document.getElementById('percent').style.color = '#4CAF50';
                circle.style.stroke = '#4CAF50';
            }
        };
        
        // 图片加载
        const loadImages = async () => {
            try {
                // 获取图片列表（模拟）
                const imageFiles = await getImageFiles();
                if (imageFiles.length === 0) throw new Error('未找到图片');
                
                updateProgress(0, imageFiles.length);
                let loaded = 0;
                
                // 加载每张图片
                imageFiles.forEach((src, i) => {
                    const img = new Image();
                    img.src = src;
                    img.alt = `作品 ${i + 1}`;
                    
                    img.onload = img.onerror = () => {
                        loaded++;
                        updateProgress(loaded, imageFiles.length);
                        
                        if (loaded === imageFiles.length) {
                            setTimeout(() => {
                                document.getElementById('loading').classList.add('hidden');
                                displayImages(imageFiles);
                            }, 800);
                        }
                    };
                });
            } catch (e) {
                console.error(e);
                document.getElementById('loading').classList.add('hidden');
                document.getElementById('error').classList.add('show');
            }
        };
        
        // 显示图片
        const displayImages = (images) => {
            const portfolio = document.getElementById('portfolio');
            images.forEach((src, i) => {
                const div = document.createElement('div');
                div.className = 'image-item';
                div.innerHTML = `<img src="${src}" alt="作品 ${i + 1}">`;
                portfolio.appendChild(div);
                
                setTimeout(() => div.classList.add('show'), 50);
            });
        };
        
        // 模拟获取图片文件
        const getImageFiles = async () => {
            await new Promise(r => setTimeout(r, 300));
            
            const files = [];
            for (let i = 1; i <= 50; i++) {
                const png = await checkImage(`images/work${i}.png`);
                const jpg = await checkImage(`images/work${i}.jpg`);
                const jpeg = await checkImage(`images/work${i}.jpeg`);
                
                if (png) files.push(`images/work${i}.png`);
                else if (jpg) files.push(`images/work${i}.jpg`);
                else if (jpeg) files.push(`images/work${i}.jpeg`);
                else break;
            }
            
            // 如果没有本地图片，使用示例图片
            if (files.length === 0) {
                for (let i = 1; i <= 6; i++) {
                    files.push(`https://picsum.photos/seed/work${i}/1200/800`);
                }
            }
            
            return files;
        };
        
        const checkImage = (url) => {
            return new Promise(resolve => {
                const img = new Image();
                img.onload = () => resolve(true);
                img.onerror = () => resolve(false);
                img.src = url;
                setTimeout(() => resolve(false), 500);
            });
        };
        
        // 重新加载
        document.getElementById('reloadBtn').addEventListener('click', () => {
            document.getElementById('error').classList.remove('show');
            document.getElementById('loading').classList.remove('hidden');
            document.getElementById('percent').textContent = '0%';
            document.getElementById('percent').style.color = '#fff';
            circle.style.stroke = '#fff';
            circle.style.strokeDashoffset = circumference;
            document.getElementById('portfolio').innerHTML = '';
            loadImages();
        });
        
        // 初始化
        setTimeout(loadImages, 300);
        window.addEventListener('beforeunload', () => window.scrollTo(0, 0));
    </script>
</body>
</html>
